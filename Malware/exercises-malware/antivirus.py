import sys
import base64
from Crypto.Cipher import AES

def findPattern(filename, pattern):
    found_string = None

    with open(filename, "r") as file:
        lines = file.readlines()

    for line in lines:
        if pattern in line:
            found_string = line[line.index('(') + 1:line.index(')')]
            break

    return found_string


def decrypt_payload(key, c1):
    theKey = base64.b64decode(key)
    encrypted = base64.b64decode(c1)
    cipher = AES.new(theKey)
    c2 = cipher.decrypt(encrypted)
    return c2.decode()
def check(filename):
    # Your solution.
    result = 0
    key = findPattern(filename, "key = base64.b64decode(\"")
    c1 = findPattern(filename, "c1 = base64.b64decode(\"")

    if c1 is not None and key is not None:
        c2 = decrypt_payload(key, c1)
    else:
        with open(filename, "r") as file:
            c2 = file.read()

    with open("payload1.py", "r") as file1:
        payload1 = file1.read()

    with open("payload2.py", "r") as file2:
        payload2 = file2.read()

    if payload1 in c2:
        result = 1
    elif payload2 in c2:
        result = 2
    else:
        result = None

    return result
    
    
if __name__ == '__main__':
    check(sys.argv[1])